# Миграции

## Правила именования

- Обычные миграции: `V{версия}__описание.ts` (например, `V1.0.0__initial.ts`)
- Тестовые миграции: `V{версия}__описание__test.ts` (например, `V1.0.2__blockchain_data_sync__test.ts`)

## Поведение

- Обычные миграции применяются только один раз, если их версия ещё не применялась.
- Тестовые миграции (файлы с `__test` в имени) запускаются всегда, даже если версия уже применялась.
- Флаг `isTest` в коде миграции больше не используется — только по имени файла.
- Если в миграции указан параметр `validUntil` (дата), то миграция не будет применена, если эта дата уже прошла (по UTC).

## Пример

- `V1.0.0__initial.ts` — обычная миграция
- `V1.0.2__blockchain_data_sync__test.ts` — тестовая миграция

## validUntil

В объекте миграции можно указать поле `validUntil` типа `Date`. Если текущая дата превышает это значение, миграция не будет применена.

```ts
export default {
  name: 'example',
  validUntil: new Date('2024-07-01T00:00:00Z'),
  up: async ({ blockchain }) => {
    /* ... */
  },
};
```
