# Расширение Capital

Модуль управления капитализацией результатов интеллектуальной деятельности в проектах кооператива.

## Описание

Capital реализует систему управления проектами и распределения долей в результатах интеллектуальной деятельности согласно принципам целевой программы "Благорост".

## Основные возможности

### Управление циклами и проектами
- Создание и управление циклами (спринтами)
- Создание проектов с указанием авторов и их долей
- Жизненный цикл проекта: ожидание → планирование → деяние → подведение итогов → распределение → закрыт

### Управление заданиями
- Создание заданий в рамках проектов
- Назначение мастеров и создателей
- Планирование времени и расходов
- Отслеживание историй (критериев выполнения)

### Система коммитов
- Подача коммитов создателями с указанием затраченного времени
- Проверка и принятие коммитов мастерами
- Автоматический расчет стоимости на основе ставок

### Расчет долей в результате
- Автоматический расчет долей создателей, авторов и координаторов
- Система премий и компенсаций
- Распределение согласно математическому ядру программы "Благорост"

## Архитектура

Модуль построен согласно принципам чистой архитектуры:

- **Domain Layer**: Доменные сущности, интерфейсы репозиториев и бизнес-логика
- **Application Layer**: Сервисы приложения, DTO и оркестрация
- **Infrastructure Layer**: TypeORM репозитории и подключение к базе данных
- **Presentation Layer**: GraphQL резолверы и API

## API

### Mutations

- `createProject` - создание проекта
- `createAssignment` - создание задания
- `submitCommit` - подача коммита создателем
- `reviewCommit` - проверка коммита мастером
- `completeAssignment` - завершение задания
- `markStoryCompleted` - отметка истории как выполненной

### Queries

- `getProjects` - получение списка проектов
- `getProject` - получение проекта по ID
- `getAssignmentsByProject` - получение заданий проекта
- `getCommitsByAssignment` - получение коммитов задания

## Конфигурация

```json
{
  "defaultHourCost": 2000,
  "coordinatorPercent": 4,
  "authorPercent": 61.8
}
```

- `defaultHourCost` - стандартная стоимость часа в рублях
- `coordinatorPercent` - процент координатора от общей суммы
- `authorPercent` - процент авторов от стоимости времени создателей
